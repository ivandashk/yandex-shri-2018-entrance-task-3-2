# Комментарии
Для вызова функции расчета потребляемой электроэнергии:
```
const calculate = require('./src/power-calculator');
calculate(input);
```

Функцию валидации входных данных можно запускать отдельно:
```
const validate = require('./src/validator');
validate(input);
```

Для запуска тестов:
```
npm test
```
или: 
```
jest
```

**Пример входных-выходных данных был перенесен в тесты: tests/data-source/calculation/default**

## Используемые библиотеки
- **jest** - популярная, мощная, удобная библиотека для тестирования.
- **ajv** - валидация входного json-объекта на основе схемы. Сильно упрощает процесс валидации, высокая произодительность.
- **fs**, **path** - для удобной организации тестов (встроенные библиотеки node.js) 

## Ограничения на входные данные
**Тесты на проверку обратных утверждений находятся в разделе tests/data-source/validation**
- Строгая типизация входных данных

- Установка свойств devices, rates и maxPower в качестве обязательных
- Установка свойств id, name, power и duration в качестве обязательных для каждого объекта массива devices
- Минимальное количество приборов: 1
- Свойство id определяется регулярным выражением - состоит из цифр и заглавных букв латинского алфавита длиной 32 символа
- Длина названия прибора должна быть не короче 1 символа
- Мощность прибора должна быть больше нуля
- Продолжительность цикла работы прибора должна составлять от 1 до 24 часов
- Режим работы может быть "day", "night" или не задан
- Продолжительность прибора не должна превышать продолжительность его режима, если он задан

- Мощность прибора не должна превышать максимально допустимую мощность
- Максимальная мощность должна быть больше нуля

- Установка свойств from, to, value в качестве обязательных для каждого объекта массива rates
- Ограничение минимального количества тарифов: 2. Случай с одним тарифом делает свойства from и to объектов массива rates необязательными и позволяет приборам работать в любое время, что лишает задачу смысла
- Свойства from и to могут принимать значения от 1 до 24
- Значение тарифа должно быть больше нуля
- Сумма всех интервалов тарифов равна 24м часам

## Дополнительно
Задача из класса дискретной оптимизации с элементами теории расписаний.
Если изобразить задачу с тестовыми данными графически, получится следующая картина: 

![1](https://pp.userapi.com/c848616/v848616427/499ce/uLctqiP5R3U.jpg)

Задача сводится к оптимизации расположения заданных прямоугольных блоков с дополнительными условиями:
1. Временные интервалы внутри режимов имеют приоритет (тарифы), зависящий от входных данных
2. Устройства с неустановленным режимом могут пересекать границу суточного цикла и границу режимов

Ввиду дополнительных условий, не удалось вывести алгоритм аналитически, однако был реализован интуитивный алгоритм, способный обработать ряд вариаций входных данных.

---
# Задание 3 — реализовать алгоритм

В этом репозитории находятся материалы тестового задания по JavaScript для [14-й Школы разработки интерфейсов](https://academy.yandex.ru/events/frontend/shri_msk-2018-2) (осень 2018, Москва, Санкт-Петербург, Симферополь).

Цель задания — реализовать алгоритм работы «умного дома», который будет производить расчёт стоимости потребляемой электроэнергии в день и возвращать рекомендованное расписание использования электроприборов, оптимизируя денежные затраты.

На вход подаются данные о тарифах, электроприборах и их максимальной потребляемой мощности.

Тарифы — это периоды в сутках, для которых задана отдельная стоимость киловатт-часа.

Приборы — это набор подключенных к «умному дому» электроприборов, для которых известна потребляемая мощность, длительность цикла работы, а также время дня, когда они используется. Каждый прибор должен отработать один цикл в сутки. Максимально потребляемая мощность указывается в ватт-часах.

На выходе должно получиться суточное расписание включения электроприборов. Каждый прибор за сутки должен отработать один цикл, а суммарная стоимость потраченной электроэнергии должна быть минимальной.

При значении mode — day период с 07:00 до 21:00. 
При значении mode — night период с 21:00 до 07:00 следующего дня. 
При значении mode — undefined период отсутствует, прибор может работать в любой промежуток времени.

Примеры: 

- [входные данные](./data/input.json)
- [выходные данные](./data/output.json)

